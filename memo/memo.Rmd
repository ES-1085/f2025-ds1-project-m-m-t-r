---
title: "Project memo"
author: "MMTR"
output: github_document
---

```{r load-packages, message = FALSE}
library(tidyverse)
library(broom)
library(viridisLite)
library(ggplot2)
```

## Data Clean Up Steps for Overall Data

### Step 1: Upload main dataset

```{r upload-data}
heatwaves_coral_fish <- read_csv("../data/VanWert_etal_2023_hawkfish.csv")
glimpse(heatwaves_coral_fish)
```

### Step 2: Change Variable Names

```{r rename-variables}
heatwaves_coral_fish_clean <- heatwaves_coral_fish |>
  rename(wet_mass = bw_g,
         total_length = tl_cm,
         standard_length = sl_cm,
         max_metabolic_rate = mmr_corrected,
         standard_metabolic_rate = smr_low10_all,
         absolute_aerobic_scope = aas_corrected,
         factorial_aerobic_scope = fas,
         SDA_coeff = sda_coeff,
         temp_of_arrhythmia = tarr,
         peak_max_heart_rate = fhmax_peak,
         temp_at_max_heart_rate = tpeak)
```

## Plots

### Plot 1: Boxplot: Heatwave treatment vs. maximum metabolic rate (MMR)


```{r boxplot-treatment-vs-MMR}

heatwave_vs_mmr <- heatwaves_coral_fish_clean |>
  filter(treatment_new != "wild") |>
  ggplot(aes(x = treatment_new, y = max_metabolic_rate, fill = season)) +
  geom_boxplot() +
  scale_x_discrete(labels = function(x) paste0(x, "°C")) +
  labs(
    title = "Maximum Metabolic Rate by Heatwave Treatment",
    subtitle = "Fish MMR is lowest at 28°C heatwaves and peaks at 31°C",
    x = "Treatment (Heatwave Temperature)",
    y = "Maximum Metabolic Rate (MMR)",
    fill = "Season"
  )

# Save the plot
ggsave("fig_mmr_vs_heatwave_boxplot.png", heatwave_vs_mmr, width = 7, height = 5)

```

### Plot 2: Scatter Plot: Treatment vs. post-feeding energy use, colored by season

```{r scatter-temp-energy-season}

temp_energy_season <- heatwaves_coral_fish_clean |>
  filter(treatment_new != "wild") |>
  ggplot(aes(x = treatment_new, y = SDA_integrated, color = season)) +
  geom_point(alpha = 0.8, size = 3) +
  scale_x_discrete(labels = function(x) ifelse(x == "wild", "wild", paste0(x, "°C"))) +
  labs(
    title = "Temperature vs. SDA (by Season)",
    subtitle = "Warmer summer temperatures make digestion more energetically costly",
    x = "Temperature Treatment",
    y = "SDA"
  )

# Save the plot
ggsave("fig_temp_energy_season_scatterplot.png", temp_energy_season, width = 7, height = 5)
```


### Plot 3:Time graph, seasonal cycle of metabolic rate
```{r metabolic-rate-per-season}

df <- read.csv("../data/VanWert_etal_2023_hawkfish.csv")
seasonal_cycle <- df$season <- factor(df$season, 
                    levels = c("winter", "spring", "summer", "fall"))


season_means <- df |>
  group_by(season) |>
  summarise(mean_mmr = mean(mmr_corrected, na.rm = TRUE))


ggplot(season_means, aes(x = season, y = mean_mmr, group = 1)) +
  geom_line(size = 1.2, color = "blue") +
  geom_point(size = 4, color = "darkred") +
  coord_polar() +
  theme_minimal() +
  labs(
    title = "Seasonal Cycle of Mean Metabolic Rate For Hawkfish",
    x = "",
    y = "Mean MMR (corrected)"
  ) +
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5)
   
  )

#save plot
ggsave("fig_polar_plot_metabolic_rate_per_season.png", seasonal_cycle, width = 7, height = 5)


```
### Plot 4 draft: Time faceted: Seasonal graph looking an body weight vs metabolic rate

```{r body-weight-mr-per-season}

energy_weight_season <- heatwaves_coral_fish_clean |>
  ggplot(aes(x = wet_mass, y = max_metabolic_rate, color = season)) +
  geom_point(alpha = 0.8, size = 2) +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(~ season, nrow = 1) +
  xlim(0,15)+
  theme_minimal() +
  labs(
    title = "Body Weight and Metabolic Rate Across Seasons for hawkfish",
    x = "Body Weight (g)",
    y = "MMR (corrected)"
  ) +
  theme(
    plot.title = element_text(size = 14, face = "bold", hjust = 0.5), legend.position = "none"

  )
#save plot 
ggsave("fig_body_weight_and_metabolic_rate_lineplot.png", energy_weight_season, width = 8, height = 5)

```

### Plot 5:Absolute Aerobic Scope vs Heatwave Treatment

#What is Absolute Aerobic Scope: This is the amount of energy an organism has for activites outside of basic survival. It is calculated by difference between an organism’s maximum metabolic rate and its standard metabolic rate. A higher absolute aerobic scope means an organism has more energy to available for movement, feeding, growth, or coping with stress. In our case a higher aerobic scope means the hawkfish are better able to deal with the heatwave treatments. 

#Alt Text: Horizontal Box plot that dipicts the absolute aerobic scope for fish exposed to heatwave treatments of 27°C, 28°C, 29°C, 31°C, and 33°C, separated by summer (pink) and winter (teal) seasons. Winter fish appear to have a higher aerobic scope compared to the summer fish. This means that they are able to handle the heatwave treatments better becuase they have more energy during the winter. The plot also shows among each season as the treatments get hotter the aerobic scope gets lower indicating that the harsher the heat treatment the lower the aerobic scope. 
```{r aerobic_scope_heatwaves}

aerobic_scope_treatment <- heatwaves_coral_fish_clean |>
  filter(treatment_new != "wild") |>
  mutate(treatment_new = factor(treatment_new,
                                levels = c("27", "28", "29", "31", "33"))) |>
  ggplot(aes(x = treatment_new,
             y = absolute_aerobic_scope,
             fill = season)) +
  geom_boxplot(position = position_dodge(width = 0.8)) +
  scale_x_discrete(labels = function(x) paste0(x, "°C")) +
  labs(
    title = "Absolute Aerobic Scope Across Heatwave Treatments",
    subtitle = "Lower aerobic scope indicates reduced energy available for activity",
    x = "Treatment (Heatwave Temperature)",
    y = "Absolute Aerobic Scope",
    fill = "Season"
  ) +
  theme_classic()

aerobic_scope_treatment
# Save the plot
ggsave("fig_aerobic_vs_heatwave_boxplot.png", aerobic_scope_treatment, width = 7, height = 5)

```
#Plot 6:  Boxplot: Aerobic Scope Across Seasons 
#Alt Text: Scatterplot that compares absolute aerobic scope between summer and winter hawkfish. Summer fish (pink points) show values mostly between 4 and 14. Winter fish (teal points) show higher overall aerobic scope with points ranging from about 7 to 20. This plot makes it clear that Winter fish gerneally have higher aerobic scope during this time period as opposed to summer fish. 
```{r Aerobic_Scope_Seasons}
heatwaves_coral_fish_clean |>
  ggplot(aes(x = season, y = absolute_aerobic_scope, fill = season)) +
  geom_boxplot() +
  labs(
    title = "Aerobic Scope Across Seasons",
    subtitle = "Lower aerobic scope indicates reduced energy available for activiity",
    x = "Season",
    y = "Absolute Aerobic Scope"
  ) +
  theme_classic(base_size = 14) +
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold", hjust = 0.5)
  )

heatwaves_coral_fish_clean |>
  ggplot(aes(x = season, y = absolute_aerobic_scope, color = season)) +
  geom_jitter(width = 0.15, size = 2, alpha = 0.7) +
  labs(
    title = "Aerobic Scope Across Seasons",
    subtitle = "Lower aerobic scope indicates reduced energy available for activity",
    x = "Season",
    y = "Absolute Aerobic Scope"
  ) +
  theme_classic(base_size = 14) +
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold", hjust = 0.5)
  )
```


# Plot 7: Relationship between Metabolic Rate and Aerobic Scope
# What is Absolute Aerobic Scope: Absolute Aerobic scope is the difference between an animal's maximum metabolic rate and its standard metabolic rate (lowest amount of energy needed to perform most basic functions)
# What is Maximum Metabolic Rate: highest rate of energy expenditure an animal can sustain; often measured by the oxygen consumption during sustained, vigorous activity

#Alt Text: Scatterplot that depicts the absolute aerobic scope on the y-axis and the maximum metabolic rate on the x-axis for all treatments, both winter and summer. The season is depicted in pink for summer and blue for winter. There seems to be a positive, linear relationship between maximum metabolic rate and absolute aerobic scope, such that as the maximum metabolic rate increases, so does the aerobic scope. 
```{r}
ggplot(VanWert_etal_2023_hawkfish, mapping = aes(x = mmr_corrected, y = aas_corrected, color = season)) + 
  geom_point(size = 3, alpha = 0.8) +
  labs(
    title = "Relationship between Metabolic Rate and Aeroic Scope",
    x = "Maximum Metabolic Rate",
    y = "Absolute Aerobic Scope",
    color = "Season"
  )
```





#### Final Plot 1

```{r}

```


### Plot 2: _________
```{r}


```


### Plot 3: ___________

Add more plot sections as needed. Each project should have at least 3 plots, but talk to me if you have fewer than 3.

### Plot 4: ___________ 

