---
title: "Project memo"
author: "MMTR"
output: github_document
---

```{r load-packages, message = FALSE}
library(tidyverse)
library(broom)
library(viridisLite)
library(ggplot2)
```

## Data Clean Up Steps for Overall Data

### Step 1: Upload main dataset

```{r upload-data}
heatwaves_coral_fish <- read_csv("../data/VanWert_etal_2023_hawkfish.csv")
glimpse(heatwaves_coral_fish)
```

### Step 2: Change Variable Names

```{r rename-variables}
heatwaves_coral_fish_clean <- heatwaves_coral_fish |>
  rename(wet_mass = bw_g,
         total_length = tl_cm,
         standard_length = sl_cm,
         max_metabolic_rate = mmr_corrected,
         standard_metabolic_rate = smr_low10_all,
         absolute_aerobic_scope = aas_corrected,
         factorial_aerobic_scope = fas,
         SDA_coeff = sda_coeff,
         temp_of_arrhythmia = tarr,
         peak_max_heart_rate = fhmax_peak,
         temp_at_max_heart_rate = tpeak)
```

## Plots

### Plot 1: Boxplot: Heatwave treatment vs. maximum metabolic rate (MMR)


```{r boxplot-treatment-vs-MMR}

heatwave_vs_mmr <- heatwaves_coral_fish_clean |>
  ggplot(aes(x = treatment_new, y = max_metabolic_rate)) +
  geom_boxplot(fill = "#6BAED6") +
  scale_x_discrete(labels = function(x) ifelse(x == "wild", "wild", paste0(x, "°C"))) +
  labs(
    title = "Maximum Metabolic Rate by Heatwave Treatment",
    subtitle = "“wild” is the control group (no heatwave)",
    x = "Treatment (Heatwave Temperature)",
    y = "Maximum Metabolic Rate (MMR)"
  )

# Save the plot
ggsave("fig_heatwave_boxplot.png", heatwave_vs_mmr, width = 7, height = 5)

```

### Plot 2: Scatter Plot: Treatment vs. post-feeding energy use, colored by season

```{r scatter-temp-energy-season}

temp_energy_season <- heatwaves_coral_fish_clean |>
  ggplot(aes(x = treatment_new, y = SDA_integrated, color = season)) +
  geom_point(alpha = 0.8, size = 3) +
  scale_x_discrete(labels = function(x) ifelse(x == "wild", "wild", paste0(x, "°C"))) +
  labs(
    title = "Temperature vs. SDA (by Season)",
    subtitle = "SDA stands for specific dynamic action, which measured digestive costs",
    x = "Temperature Treatment",
    y = "SDA Integrated"
  )

# Save the plot
ggsave("fig_temp_energy_season_scatterplot.png", temp_energy_season, width = 7, height = 5)
```


### Plot 3:Time graph, seasonal cycle of mettabolic rate
```{r metabolic-rate-per-season}

df <- read.csv("../data/VanWert_etal_2023_hawkfish.csv")
df$season <- factor(df$season, 
                    levels = c("winter", "spring", "summer", "fall"))


season_means <- df |>
  group_by(season) |>
  summarise(mean_mmr = mean(mmr_corrected, na.rm = TRUE))


ggplot(season_means, aes(x = season, y = mean_mmr, group = 1)) +
  geom_line(size = 1.2, color = "blue") +
  geom_point(size = 4, color = "darkred") +
  coord_polar() +
  theme_minimal() +
  labs(
    title = "Seasonal Cycle of Mean Metabolic Rate",
    x = "",
    y = "Mean MMR (corrected)"
  ) +
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5)
   
  )


```
### Plot 4 draft: Time faceted: Seasonal graph looking an body weight vs metabolic rate

```{r body-weight-mr-per-season}

df <- read.csv("../data/VanWert_etal_2023_hawkfish.csv")

df$season <- factor(df$season, 
                    levels = c("winter", "spring", "summer", "fall"))

ggplot(df, aes(x = bw_g, y = mmr_corrected, color = season)) +
  geom_point(alpha = 0.8, size = 2) +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(~ season, nrow = 1) +
  theme_minimal() +
  labs(
    title = "Body Weight vs Metabolic Rate Across Seasons",
    x = "Body Weight (g)",
    y = "MMR (corrected)"
  ) +
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5)

  )

```

### Plot 5:Absolute Aerobic Scope vs Heatwave Treatment
```{r aerobic_scope_heatwaves}
aerobic_scope_treatment <- heatwaves_coral_fish_clean |>
  ggplot(aes(x = treatment_new, y = absolute_aerobic_scope)) +
  geom_boxplot(fill = "#9ECAE1") +
  labs(
    title = "Absolute Aerobic Scope Across Heatwave Treatments",
    subtitle = "Lower aerobic scope indicates reduced energy available for activity",
    x = "Heatwave Treatment",
    y = "Absolute Aerobic Scope"
  ) +
  theme_classic()

# Display the plot
aerobic_scope_treatment
```
#Plot 6:  Boxplot: Aerobic Scope Across Seasons 
```{r Aerobic_Scope_Seasons}
heatwaves_coral_fish |>
  ggplot(aes(x = season, y = aas_corrected, fill = season)) +
  geom_boxplot() +
  labs(
    title = "Aerobic Scope Across Seasons",
    x = "Season",
    y = "Absolute Aerobic Scope (mg O₂ kg⁻¹ min⁻¹)"
  ) +
  theme_classic(base_size = 14) +
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold", hjust = 0.5)
  )
```







#### Final Plot 1

```{r}

```


### Plot 2: _________
```{r}


```


### Plot 3: ___________

Add more plot sections as needed. Each project should have at least 3 plots, but talk to me if you have fewer than 3.

### Plot 4: ___________ 

