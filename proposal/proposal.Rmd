---
title: "Project proposal"
author: "MMTR"
output: github_document
---

```{r load-packages, message = FALSE}
library(tidyverse)
library(broom)
library(readxl)
```

## 1. Introduction
The study focused on the effect of heatwaves on coral reef fish. The study was conducted by Van Wert et al. and was published on July 15, 2024. The Hawkfish were collected in Mo'orea, French Polynesia in 2019 during the winter and 2022 during the summer. They studied how marine heatwaves impacted the performance and thermal tolerance of the arceye hawkfish, which is a tropical predatory fish. 

More specifically, the researchers used five treatments (27, 28, 29, 31, or 33°C) for one week to test hawkfish’s acclimation ability, which they measured by metabolic performance metrics, including maximum metabolic rate (MMR), standard metabolic rate (SMR), and costs of digestion (specific dynamic action, SDA), using custom-made respirometry chambers. A subset of fish and wild fish were tested for thermal tolerance using an acute cardiac thermal tolerance test. 

This dataset contains 75 cases and 22 variables.

For this project, our research question focuses on the negative effects of heatwaves on hawkfish to understand the greater effect of climate change on marine populations. Some questions include:

1. What threat do heatwaves pose to hawkfish?

2. Does the season (summer vs winter) have any effect on the fish’s energy?

3. What is the long-term impact of these heatwaves on the fish’s health and physiology?

4. Will warming ocean temperatures affect the size of future hawkfish populations?

## 2. Data

The dataset including the following variables:

1. `hawkfish_no` = unique fish ID

2. `year` = year of fish collection and measurements

3. `season` = Austral summer (summer) or Austral winter (winter)

4. `treatment_new` = acclimation temperature; 'wild' indicates fish were not acclimated and were collected from the wild and immediately tested

5. `bw_g` = wet mass of fish (units g)

6. `tank` = fish tank ID during acclimation

7. `tl_cm` = total length of fish (units cm)

8. `sl_cm` = standard length of fish (units cm)

9. `chase_pre_v_post` = whether exhaustive exercise chase occurred before (pre) or after (post) SMR measurements

10. `mmr_corrected` = body mass corrected maximum metabolic rate by universal metabolic scaling coefficient of 0.89 (units mg O2 kg-1 min-1)

11. `smr_low10_all` = standard metabolic rate (units mg O2 kg-1 min-1)

12. `aas_corrected` = absolute aerobic scope (units mg O2 kg-1 min-1)

13. `fas` = factorial aerobic scope calculated as mmr/smr (unitless)

14. `percent_bw_scallop_fed` = percent of body weight scallop fed for SDA trial

15. `SDA_integrated` = integral of specific dynamic action (SDA) (units mg O2 kg-1)

16. `SDA_duration` = duration of specific dynamic action (SDA) (units hours)

17. `peak_SDA_max` = maximum metabolic oxygen consumption (MO2) reached during specific dynamic action (SDA) (units mg O2 kg-1 min-1)

18. `time_peak_SDA_max` = time at which peak_SDA_max occurred (units hours)

19. `sda_coeff` = specific dynamic action (SDA) coefficient (units %)

20. `tarr` = temperature of arrhythmia (units degC), only measured during winter tests

21. `fhmax_peak` = peak maximum heart rate (units beats per min), only measured during winter tests

22. `tpeak` = temperature at which fhmax_peak occurred (units degC), only measured during winter tests


```{r import-dataset}
heatwaves_coral_fish <- read_csv("../data/VanWert_etal_2023_hawkfish.csv")
glimpse(heatwaves_coral_fish)
```

## 3. Data analysis plan

- What variables will you visualize to explore your research questions?

Season: `season` = Austral summer (summer) or Austral winter (winter)

Temperature: `treatment_new` = acclimation temperature; 'wild' indicates fish were not acclimated and were 
Mass of fish: bw_g = wet mass of fish (units g)

Fish length: `tl_cm` = total length of fish (units cm)

Heart rate: `fhmax_peak` = peak maximum heart rate (units beats per min), only measured during winter tests
Metabolic rate

- Will there be any other data that you need to find to help with your research question?

Since our dataset only contains 75 observations, we think it will be helpful if we can find some other data in water temperatures and the amount or size of Hawkfish any other types of fish.

- The data visualization(s) that you believe will be useful in exploring your question(s). (You can update these later as you work on your project.)

Scatterplot of `mmr_corrected` vs `SDA_integrated` with points colored by `treatment_new` — to see if heatwave affects energy use after feeding.

Boxplot of `SDA_integrated` or `fas` by `season` to see if fish have higher energy use in one season.

- Very preliminary exploratory data analysis, including some summary statistics and visualizations, along with some explanation on how they help you learn more about your data. (You can add to these later as you work on your project.)


```{r summary-statistics}
heatwaves_coral_fish |>
  summarise(
    mean_mmr   = mean(mmr_corrected, na.rm = TRUE),
    median_mmr = median(mmr_corrected, na.rm = TRUE),
    min_mmr    = min(mmr_corrected, na.rm = TRUE),
    max_mmr    = max(mmr_corrected, na.rm = TRUE),

    mean_smr   = mean(smr_low10_all, na.rm = TRUE),
    median_smr = median(smr_low10_all, na.rm = TRUE),
    min_smr    = min(smr_low10_all, na.rm = TRUE),
    max_smr    = max(smr_low10_all, na.rm = TRUE),

    mean_SDA   = mean(SDA_integrated, na.rm = TRUE),
    median_SDA = median(SDA_integrated, na.rm = TRUE),
    min_SDA    = min(SDA_integrated, na.rm = TRUE),
    max_SDA    = max(SDA_integrated, na.rm = TRUE),

    mean_bw    = mean(bw_g, na.rm = TRUE),
    mean_tl    = mean(tl_cm, na.rm = TRUE)
  )
```

```{r visualizations}
# 1) Boxplot: Heatwave treatment vs. maximum metabolic rate (MMR)
heatwaves_coral_fish |>
  ggplot(aes(x = treatment_new, y = mmr_corrected)) +
  geom_boxplot() +
  labs(
    title = "MMR by Heatwave Treatment",
    x = "Treatment",
    y = "MMR (corrected)"
  )

# 2) Scatter: Body length vs. post-feeding energy use, colored by season
heatwaves_coral_fish |>
  ggplot(aes(x = tl_cm, y = SDA_integrated, color = season)) +
  geom_point(alpha = 0.8) +
  labs(
    title = "Body Length vs. SDA (by Season)",
    x = "Total Length (cm)",
    y = "SDA Integrated"
  )

```
